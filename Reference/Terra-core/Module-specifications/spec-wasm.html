<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WASM | Terra Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/7420256/6416592/css/fonts.css">
    <link rel="stylesheet" type="text/css" href="https://www.terra.money/static/fonts/jetbrainsMono.css?updated=190220">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,500,700&amp;display=swap">
    <link rel="icon" type="image/png" href="/img/favicon.png">
    <script>window.onload = function() {
        requestAnimationFrame(function() {
          if (location.hash) {
            const element = document.getElementById(location.hash.slice(1))

            if (element) {
              element.scrollIntoView()
            }
          }
        })
      }</script>
    <meta name="description" content="Terra is an open source, public blockchain protocol that provides fundamental infrastructure for a decentralized economy and enables open participation in the creation of new financial primitives to power the innovation of money.">
    
    <link rel="preload" href="/assets/css/0.styles.b90d9300.css" as="style"><link rel="preload" href="/assets/js/app.bb579b87.js" as="script"><link rel="preload" href="/assets/js/3.bd3f871b.js" as="script"><link rel="preload" href="/assets/js/56.50135bed.js" as="script"><link rel="prefetch" href="/assets/js/10.702f2eeb.js"><link rel="prefetch" href="/assets/js/11.d83e4c08.js"><link rel="prefetch" href="/assets/js/12.30fd6fcf.js"><link rel="prefetch" href="/assets/js/13.463c7cf2.js"><link rel="prefetch" href="/assets/js/14.7443f057.js"><link rel="prefetch" href="/assets/js/15.cc2ff474.js"><link rel="prefetch" href="/assets/js/16.b7303649.js"><link rel="prefetch" href="/assets/js/17.7ff360e0.js"><link rel="prefetch" href="/assets/js/18.3c97efdf.js"><link rel="prefetch" href="/assets/js/19.767c628a.js"><link rel="prefetch" href="/assets/js/20.c3b67c7e.js"><link rel="prefetch" href="/assets/js/21.ed81322c.js"><link rel="prefetch" href="/assets/js/22.d813ec61.js"><link rel="prefetch" href="/assets/js/23.6be4c4be.js"><link rel="prefetch" href="/assets/js/24.214d78e4.js"><link rel="prefetch" href="/assets/js/25.d1efda93.js"><link rel="prefetch" href="/assets/js/26.23be4177.js"><link rel="prefetch" href="/assets/js/27.65a41319.js"><link rel="prefetch" href="/assets/js/28.ed5c3ce8.js"><link rel="prefetch" href="/assets/js/29.fb35e146.js"><link rel="prefetch" href="/assets/js/30.3ccea319.js"><link rel="prefetch" href="/assets/js/31.4ca0a94d.js"><link rel="prefetch" href="/assets/js/32.1397be91.js"><link rel="prefetch" href="/assets/js/33.07cebc57.js"><link rel="prefetch" href="/assets/js/34.ced6c4b7.js"><link rel="prefetch" href="/assets/js/35.02953aa8.js"><link rel="prefetch" href="/assets/js/36.511aafec.js"><link rel="prefetch" href="/assets/js/37.fdee8eb1.js"><link rel="prefetch" href="/assets/js/38.b02aefb5.js"><link rel="prefetch" href="/assets/js/39.e3b0f4ad.js"><link rel="prefetch" href="/assets/js/4.8e884616.js"><link rel="prefetch" href="/assets/js/40.f5f6e6e2.js"><link rel="prefetch" href="/assets/js/41.e385cd8c.js"><link rel="prefetch" href="/assets/js/42.0795be7c.js"><link rel="prefetch" href="/assets/js/43.03b58b2c.js"><link rel="prefetch" href="/assets/js/44.ba137eea.js"><link rel="prefetch" href="/assets/js/45.61537e5c.js"><link rel="prefetch" href="/assets/js/46.dfc54f76.js"><link rel="prefetch" href="/assets/js/47.2afae3bf.js"><link rel="prefetch" href="/assets/js/48.600d34d0.js"><link rel="prefetch" href="/assets/js/49.3ed73a9b.js"><link rel="prefetch" href="/assets/js/5.cfa43d54.js"><link rel="prefetch" href="/assets/js/50.cc21253f.js"><link rel="prefetch" href="/assets/js/51.03862bbb.js"><link rel="prefetch" href="/assets/js/52.b6ed118d.js"><link rel="prefetch" href="/assets/js/53.9974fba3.js"><link rel="prefetch" href="/assets/js/54.52c2475b.js"><link rel="prefetch" href="/assets/js/55.805a376a.js"><link rel="prefetch" href="/assets/js/57.af392382.js"><link rel="prefetch" href="/assets/js/58.0ed5c001.js"><link rel="prefetch" href="/assets/js/59.d985eb4d.js"><link rel="prefetch" href="/assets/js/6.853fdd43.js"><link rel="prefetch" href="/assets/js/60.fc6822e4.js"><link rel="prefetch" href="/assets/js/61.65d0c9ad.js"><link rel="prefetch" href="/assets/js/62.8d356e47.js"><link rel="prefetch" href="/assets/js/63.93ea2dd9.js"><link rel="prefetch" href="/assets/js/64.c399be85.js"><link rel="prefetch" href="/assets/js/65.1ce26d20.js"><link rel="prefetch" href="/assets/js/66.caa689fd.js"><link rel="prefetch" href="/assets/js/67.0da516e7.js"><link rel="prefetch" href="/assets/js/68.2ab299b4.js"><link rel="prefetch" href="/assets/js/69.e3b97a46.js"><link rel="prefetch" href="/assets/js/7.0a026085.js"><link rel="prefetch" href="/assets/js/70.1de1c1e9.js"><link rel="prefetch" href="/assets/js/71.a837a9b4.js"><link rel="prefetch" href="/assets/js/72.ad9e6958.js"><link rel="prefetch" href="/assets/js/73.e5f402df.js"><link rel="prefetch" href="/assets/js/74.f4a9a475.js"><link rel="prefetch" href="/assets/js/75.a22d689c.js"><link rel="prefetch" href="/assets/js/76.2a314a8b.js"><link rel="prefetch" href="/assets/js/77.dbcaf9c0.js"><link rel="prefetch" href="/assets/js/78.4d0ab581.js"><link rel="prefetch" href="/assets/js/79.f99146bb.js"><link rel="prefetch" href="/assets/js/8.087c7e3b.js"><link rel="prefetch" href="/assets/js/80.c61f507f.js"><link rel="prefetch" href="/assets/js/81.bc47d9cf.js"><link rel="prefetch" href="/assets/js/82.ca602b8e.js"><link rel="prefetch" href="/assets/js/83.a0de260d.js"><link rel="prefetch" href="/assets/js/84.865f2a5b.js"><link rel="prefetch" href="/assets/js/85.6ce94127.js"><link rel="prefetch" href="/assets/js/86.fbb52d1c.js"><link rel="prefetch" href="/assets/js/87.bc68c044.js"><link rel="prefetch" href="/assets/js/88.558000c2.js"><link rel="prefetch" href="/assets/js/89.d3d1cc42.js"><link rel="prefetch" href="/assets/js/9.5c8389f5.js"><link rel="prefetch" href="/assets/js/90.56dcd92d.js"><link rel="prefetch" href="/assets/js/91.279946a8.js"><link rel="prefetch" href="/assets/js/92.7aae198a.js"><link rel="prefetch" href="/assets/js/93.884328a7.js"><link rel="prefetch" href="/assets/js/94.abfbf92f.js"><link rel="prefetch" href="/assets/js/95.3f6a6eb3.js"><link rel="prefetch" href="/assets/js/96.4609ac8b.js"><link rel="prefetch" href="/assets/js/97.6228f4cb.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.1b3c7a9c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b90d9300.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"></div> <a href="/" class="home-link router-link-active"><img src="/img/docs_logo.svg" alt="Terra Docs" class="logo"> <span class="site-name can-hide">Terra Docs</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/Tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/How-to/" class="nav-link">How to</a></div><div class="nav-item"><a href="/Concepts/" class="nav-link">Concepts</a></div><div class="nav-item"><a href="/Reference/" class="nav-link router-link-active">Reference</a></div><div class="nav-item"><a href="/SDKs/" class="nav-link">SDKs</a></div><div class="nav-item"><a href="https://github.com/terra-money/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form></div></header> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/Tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/How-to/" class="nav-link">How to</a></div><div class="nav-item"><a href="/Concepts/" class="nav-link">Concepts</a></div><div class="nav-item"><a href="/Reference/" class="nav-link router-link-active">Reference</a></div><div class="nav-item"><a href="/SDKs/" class="nav-link">SDKs</a></div><div class="nav-item"><a href="https://github.com/terra-money/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav>  <ul class="sidebar-links"><li><a href="/Reference/" aria-current="page" class="sidebar-link">Reference</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Terra core</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Reference/Terra-core/Overview.html" class="sidebar-link">Developer guide</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-auth.html" class="sidebar-link">Auth</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-authz.html" class="sidebar-link">AuthZ</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-bank.html" class="sidebar-link">Bank</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-capability.html" class="sidebar-link">Capability</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-distribution.html" class="sidebar-link">Distribution</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-evidence.html" class="sidebar-link">Evidence</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-feegrant.html" class="sidebar-link">Fee grant</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-governance.html" class="sidebar-link">Governance</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-market.html" class="sidebar-link">Market</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-mint.html" class="sidebar-link">Mint</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-oracle.html" class="sidebar-link">Oracle</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-slashing.html" class="sidebar-link">Slashing</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-staking.html" class="sidebar-link">Staking</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-treasury.html" class="sidebar-link">Treasury</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html" aria-current="page" class="active sidebar-link">WASM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#concepts" class="sidebar-link">Concepts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#smart-contracts" class="sidebar-link">Smart Contracts</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#interaction" class="sidebar-link">Interaction</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#wasmer-vm" class="sidebar-link">Wasmer VM</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#gas-fees" class="sidebar-link">Gas Fees</a></li></ul></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#data" class="sidebar-link">Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#codeinfo" class="sidebar-link">CodeInfo</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#contractinfo" class="sidebar-link">ContractInfo</a></li></ul></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#state" class="sidebar-link">State</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#last-code-id" class="sidebar-link">Last Code ID</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#last-instance-id" class="sidebar-link">Last Instance ID</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#code" class="sidebar-link">Code</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#contract-info" class="sidebar-link">Contract Info</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#contract-store" class="sidebar-link">Contract Store</a></li></ul></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#message-types" class="sidebar-link">Message Types</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#msgstorecode" class="sidebar-link">MsgStoreCode</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#msginstantiatecontract" class="sidebar-link">MsgInstantiateContract</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#msgexecutecontract" class="sidebar-link">MsgExecuteContract</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#msgmigratecontract" class="sidebar-link">MsgMigrateContract</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#msgupdatecontractowner" class="sidebar-link">MsgUpdateContractOwner</a></li></ul></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#parameters" class="sidebar-link">Parameters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#maxcontractsize" class="sidebar-link">MaxContractSize</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#maxcontractgas" class="sidebar-link">MaxContractGas</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html#maxcontractmsgsize" class="sidebar-link">MaxContractMsgSize</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>terrad</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Reference/integrations.html" class="sidebar-link">Integrations</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Ecosystem</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Reference/endpoints.html" class="sidebar-link">RPC endpoints</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other resources</span> <span class="arrow right"></span></p> <!----></section></li></ul>  <div class="sidebar_footer"></div></aside> <main class="page"> <nav id="breadcrumb" class="breadcrumb-container" data-v-7ebed944><a href="/" class="breadcrumb router-link-active" data-v-7ebed944><span data-v-7ebed944>Terra Docs</span></a><a href="/Reference/" class="breadcrumb router-link-active" data-v-7ebed944><span data-v-7ebed944>Reference</span></a><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html" aria-current="page" class="breadcrumb router-link-exact-active router-link-active" data-v-7ebed944><span data-v-7ebed944>WASM</span></a></nav> <div class="theme-default-content content__default"><h1 id="wasm"><a href="#wasm" class="header-anchor">#</a> WASM</h1> <p>The WASM module implements the execution environment for WebAssembly smart contracts, powered by <a href="https://cosmwasm.com" target="_blank" rel="noopener noreferrer">CosmWasm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="concepts"><a href="#concepts" class="header-anchor">#</a> Concepts</h2> <h3 id="smart-contracts"><a href="#smart-contracts" class="header-anchor">#</a> Smart Contracts</h3> <p>Smart contracts are autonomous agents that are able to interact with other entities on the Terra blockchain, such as human-owned accounts, validators, and other smart contracts. Each smart contract has:</p> <ul><li>A unique <strong>contract address</strong> with an account that holds funds.</li> <li>A <strong>code ID</strong>, where its logic is defined.</li> <li>Its own <strong>key-value store</strong>, where it can persist and retrieve data.</li></ul> <h4 id="contract-address"><a href="#contract-address" class="header-anchor">#</a> Contract Address</h4> <p>Upon instantiation, each contract is automatically assigned a Terra account address, called the <em>contract address</em>. The address is procedurally generated on-chain without an accompanying private / public key pair, and can be completely determined by the contract's number order of existence. For instance, on two separate Terra networks, the first contract will always be assigned the address <code>terra18vd8fpwxzck93qlwghaj6arh4p7c5n896xzem5</code>, and similarly for the second, third, and so forth.</p> <h4 id="code-id"><a href="#code-id" class="header-anchor">#</a> Code ID</h4> <p>On Terra, code upload and contract creation occur as separate events. A smart contract writer first uploads WASM bytecode onto the blockchain to obtain a <em>code ID</em>, which they can then use to initialize an instance of that contract. This scheme promotes efficient storage, as most contracts share the same underlying logic and vary only in their initial configuration. Vetted, high quality contracts for common use cases such as fungible tokens and multisig wallets can be easily reused without the need to upload new code.</p> <h4 id="key-value-store"><a href="#key-value-store" class="header-anchor">#</a> Key-Value Store</h4> <p>Every smart contract is given its own dedicated keyspace in LevelDB, prefixed by the contract address. Contract code is safely sandboxed and can only can set and delete new keys and values within its assigned keyspace.</p> <h3 id="interaction"><a href="#interaction" class="header-anchor">#</a> Interaction</h3> <p>Users can interact with smart contracts in several ways.</p> <h4 id="instantiation"><a href="#instantiation" class="header-anchor">#</a> Instantiation</h4> <p>A user can instantiate a new smart contract by sending a <code>MsgInstantiateContract</code>. This message enables the user to:</p> <ul><li>assign an owner to the contract.</li> <li>specify code will be used for the contract via a code ID.</li> <li>define the initial parameters / configuration through an <code>InitMsg</code>.</li> <li>provide the new contract's account with some initial funds.</li> <li>denote whether the contract is migratable (able to change code IDs).</li></ul> <p>The <code>InitMsg</code> is a JSON message whose expected format is defined in the contract's code. Every contract contains a section that defines how to set up the initial state depending on the provided <code>InitMsg</code>.</p> <h4 id="execution"><a href="#execution" class="header-anchor">#</a> Execution</h4> <p>A user can execute a smart contract to invoke one of its defined functions by sending a <code>MsgExecuteContract</code>. In it, the user is able to:</p> <ul><li>specify which function to call with a <code>HandleMsg</code></li> <li>send funds to the contract, which may be expected during execution</li></ul> <p>The <code>HandleMsg</code> is a JSON message that containing function call arguments and gets routed to the appropriate handling logic. From there, the contract executes the function's instructions, during which the contract's own state can modified. The contract can only modify outside state (such as state in other contracts or modules) after its own execution has ended, by returning a list of blockchain messages such as <code>MsgSend</code> and <code>MsgSwap</code>. These messages are appended to the same transaction as the <code>MsgExecuteContract</code>, and if any of the messages are invalid, the whole transaction is invalidated.</p> <h4 id="migration"><a href="#migration" class="header-anchor">#</a> Migration</h4> <p>If a user is the contract's owner, and a contract is instantiated as migratable, they can issue a <code>MsgMigrateContract</code> to reset its code ID to a new one. The migration is be parameterized with a <code>MigrateMsg</code>, a JSON message.</p> <h4 id="transfer-of-ownership"><a href="#transfer-of-ownership" class="header-anchor">#</a> Transfer of Ownership</h4> <p>The current owner of the smart contract can re-assign a new owner to the contract with <code>MsgUpdateContractOwner</code>.</p> <h4 id="query"><a href="#query" class="header-anchor">#</a> Query</h4> <p>Contracts can define query functions, or read-only operations meant for data-retrieval. This allows contracts to expose rich, custom data endpoints with JSON responses instead of raw bytes from the low-level key-value store. Because the blockchain state cannot be changed, the node can directly run the query without a transaction.</p> <p>Users can specify which query function alongside any arguments with a JSON <code>QueryMsg</code>. Even though there is no gas fee, the query function's execution is capped by gas determined by metered execution (which is not charged) as a form of spam-protection.</p> <h3 id="wasmer-vm"><a href="#wasmer-vm" class="header-anchor">#</a> Wasmer VM</h3> <p>The actual execution of WASM bytecode is performed by <a href="https://github.com/wasmerio/wasmer" target="_blank" rel="noopener noreferrer">wasmer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which provides a lightweight sandboxed runtime with metered execution to account for the resource cost of computation.</p> <h4 id="gas-meter"><a href="#gas-meter" class="header-anchor">#</a> Gas Meter</h4> <p>In addition to the regular gas fees incurred from creating the transaction, Terra also calculates a separate gas when executing smart contract code. This is tracked by the <strong>gas meter</strong>, which is during the execution of every opcode and gets translated back to native Terra gas via a constant multiplier (currently set to 100).</p> <h3 id="gas-fees"><a href="#gas-fees" class="header-anchor">#</a> Gas Fees</h3> <p>Wasm data and event spend gas up to <code>1 * bytes</code>. Passing the event &amp; data to another contract also spends gas in reply.</p> <h2 id="data"><a href="#data" class="header-anchor">#</a> Data</h2> <h3 id="codeinfo"><a href="#codeinfo" class="header-anchor">#</a> CodeInfo</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> CodeInfo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	CodeID   <span class="token builtin">uint64</span>           <span class="token string">`json:&quot;code_id&quot;`</span>
	CodeHash core<span class="token punctuation">.</span>Base64Bytes <span class="token string">`json:&quot;code_hash&quot;`</span>
	Creator  sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;creator&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="contractinfo"><a href="#contractinfo" class="header-anchor">#</a> ContractInfo</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> ContractInfo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Address    sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;address&quot;`</span>
	Owner      sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;owner&quot;`</span>
	CodeID     <span class="token builtin">uint64</span>           <span class="token string">`json:&quot;code_id&quot;`</span>
	InitMsg    core<span class="token punctuation">.</span>Base64Bytes <span class="token string">`json:&quot;init_msg&quot;`</span>
	Migratable <span class="token builtin">bool</span>             <span class="token string">`json:&quot;migratable&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="state"><a href="#state" class="header-anchor">#</a> State</h2> <h3 id="last-code-id"><a href="#last-code-id" class="header-anchor">#</a> Last Code ID</h3> <ul><li>type: <code>uint64</code></li></ul> <p>A counter for the last uploaded code ID.</p> <h3 id="last-instance-id"><a href="#last-instance-id" class="header-anchor">#</a> Last Instance ID</h3> <ul><li>type: <code>uint64</code></li></ul> <p>A counter for the last instantiated contract number.</p> <h3 id="code"><a href="#code" class="header-anchor">#</a> Code</h3> <ul><li>type: <code>map[uint64]CodeInfo</code></li></ul> <p>Maps a code ID to <code>CodeInfo</code> entry.</p> <h3 id="contract-info"><a href="#contract-info" class="header-anchor">#</a> Contract Info</h3> <ul><li>type: <code>map[bytes]ContractInfo</code></li></ul> <p>Maps contract address to its corresponding <code>ContractInfo</code>.</p> <h3 id="contract-store"><a href="#contract-store" class="header-anchor">#</a> Contract Store</h3> <ul><li>type: <code>map[bytes]KVStore</code></li></ul> <p>Maps contract address to its dedicated KVStore.</p> <h2 id="message-types"><a href="#message-types" class="header-anchor">#</a> Message Types</h2> <h3 id="msgstorecode"><a href="#msgstorecode" class="header-anchor">#</a> MsgStoreCode</h3> <p>Uploads new code to the blockchain, and results in a new code ID if successful. <code>WASMByteCode</code> is accepted as either uncompressed or gzipped binary data encoded as Base64.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MsgStoreCode <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Sender sdk<span class="token punctuation">.</span>AccAddress <span class="token string">`json:&quot;sender&quot; yaml:&quot;sender&quot;`</span>
	<span class="token comment">// WASMByteCode can be raw or gzip compressed</span>
	WASMByteCode core<span class="token punctuation">.</span>Base64Bytes <span class="token string">`json:&quot;wasm_byte_code&quot; yaml:&quot;wasm_byte_code&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="msginstantiatecontract"><a href="#msginstantiatecontract" class="header-anchor">#</a> MsgInstantiateContract</h3> <p>Creates a new instance of a smart contract. Initial configuration is provided in the <code>InitMsg</code>, which is a JSON message encoded in Base64. If <code>Migratable</code> is set to be <code>true</code>, the owner of the contract is permitted to reset the contract's code ID to a new one.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MsgInstantiateContract <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// Sender is an sender address</span>
	Sender <span class="token builtin">string</span> <span class="token string">`protobuf:&quot;bytes,1,opt,name=sender,proto3&quot; json:&quot;sender,omitempty&quot; yaml:&quot;sender&quot;`</span>
	<span class="token comment">// Admin is an optional admin address who can migrate the contract</span>
	Admin <span class="token builtin">string</span> <span class="token string">`protobuf:&quot;bytes,2,opt,name=admin,proto3&quot; json:&quot;admin,omitempty&quot; yaml:&quot;admin&quot;`</span>
	<span class="token comment">// CodeID is the reference to the stored WASM code</span>
	CodeID <span class="token builtin">uint64</span> <span class="token string">`protobuf:&quot;varint,3,opt,name=code_id,json=codeId,proto3&quot; json:&quot;code_id,omitempty&quot; yaml:&quot;code_id&quot;`</span>
	<span class="token comment">// InitMsg json encoded message to be passed to the contract on instantiation</span>
	InitMsg encoding_json<span class="token punctuation">.</span>RawMessage <span class="token string">`protobuf:&quot;bytes,4,opt,name=init_msg,json=initMsg,proto3,casttype=encoding/json.RawMessage&quot; json:&quot;init_msg,omitempty&quot; yaml:&quot;init_msg&quot;`</span>
	<span class="token comment">// InitCoins that are transferred to the contract on execution</span>
	InitCoins github_com_cosmos_cosmos_sdk_types<span class="token punctuation">.</span>Coins <span class="token string">`protobuf:&quot;bytes,5,rep,name=init_coins,json=initCoins,proto3,castrepeated=github.com/cosmos/cosmos-sdk/types.Coins&quot; json:&quot;init_coins&quot; yaml:&quot;init_coins&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="msgexecutecontract"><a href="#msgexecutecontract" class="header-anchor">#</a> MsgExecuteContract</h3> <p>Invoke a function defined within the smart contract. Function and parameters are encoded in <code>ExecuteMsg</code>, which is a JSON message encoded in Base64.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MsgExecuteContract <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Sender     sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;sender&quot; yaml:&quot;sender&quot;`</span>
	Contract   sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;contract&quot; yaml:&quot;contract&quot;`</span>
	ExecuteMsg core<span class="token punctuation">.</span>Base64Bytes <span class="token string">`json:&quot;execute_msg&quot; yaml:&quot;execute_msg&quot;`</span>
	Coins      sdk<span class="token punctuation">.</span>Coins        <span class="token string">`json:&quot;coins&quot; yaml:&quot;coins&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="msgmigratecontract"><a href="#msgmigratecontract" class="header-anchor">#</a> MsgMigrateContract</h3> <p>Can be issued by the owner of a migratable smart contract to reset its code ID to another one. <code>MigrateMsg</code> is a JSON message encoded in Base64.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MsgMigrateContract <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Owner      sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;owner&quot; yaml:&quot;owner&quot;`</span>
	Contract   sdk<span class="token punctuation">.</span>AccAddress   <span class="token string">`json:&quot;contract&quot; yaml:&quot;contract&quot;`</span>
	NewCodeID  <span class="token builtin">uint64</span>           <span class="token string">`json:&quot;new_code_id&quot; yaml:&quot;new_code_id&quot;`</span>
	MigrateMsg core<span class="token punctuation">.</span>Base64Bytes <span class="token string">`json:&quot;migrate_msg&quot; yaml:&quot;migrate_msg&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="msgupdatecontractowner"><a href="#msgupdatecontractowner" class="header-anchor">#</a> MsgUpdateContractOwner</h3> <p>Can be issued by the smart contract's owner to transfer ownership.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MsgUpdateContractOwner <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Owner    sdk<span class="token punctuation">.</span>AccAddress <span class="token string">`json:&quot;owner&quot; yaml:&quot;owner&quot;`</span>
	NewOwner sdk<span class="token punctuation">.</span>AccAddress <span class="token string">`json:&quot;new_owner&quot; yaml:&quot;new_owner&quot;`</span>
	Contract sdk<span class="token punctuation">.</span>AccAddress <span class="token string">`json:&quot;contract&quot; yaml:&quot;contract&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h2> <p>The subspace for the WASM module is <code>wasm</code>.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> Params <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	MaxContractSize    <span class="token builtin">uint64</span> <span class="token string">`json:&quot;max_contract_size&quot; yaml:&quot;max_contract_size&quot;`</span>
	MaxContractGas     <span class="token builtin">uint64</span> <span class="token string">`json:&quot;max_contract_gas&quot; yaml:&quot;max_contract_gas&quot;`</span>
	MaxContractMsgSize <span class="token builtin">uint64</span> <span class="token string">`json:&quot;max_contract_msg_size&quot; yaml:&quot;max_contract_msg_size&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="maxcontractsize"><a href="#maxcontractsize" class="header-anchor">#</a> MaxContractSize</h3> <ul><li>type: <code>uint64</code></li></ul> <p>Maximum contract bytecode size, in bytes.</p> <h3 id="maxcontractgas"><a href="#maxcontractgas" class="header-anchor">#</a> MaxContractGas</h3> <ul><li>type: <code>uint64</code></li></ul> <p>Maximum contract gas consumption during any execution.</p> <h3 id="maxcontractmsgsize"><a href="#maxcontractmsgsize" class="header-anchor">#</a> MaxContractMsgSize</h3> <ul><li>type: <code>uint64</code></li></ul> <p>Maximum contract message size, in bytes.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/terra-money/docs/edit/main/docs/Reference/Terra-core/Module-specifications/spec-wasm.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Updated on:</span> <span class="time">1/20/2022, 4:08:51 PM</span></div></footer> <div class="page-nav"><div class="inner"><div class="prev"><a href="/Reference/Terra-core/Module-specifications/spec-treasury.html">Treasury</a></div> <div class="next"><a href="/Reference/terrad/">Using terrad</a></div></div></div>  <div class="footer-container"><div class="company"><div class="copyright">Terraform labs PTE.LTD</div> <div class="subscribe"><div class="subscribe-title">Subscribe to get updates</div> <form action="https://money.us17.list-manage.com/subscribe/post?u=8eca8dc5c91c2e30d69b1463e&id=1447662093" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" novalidate="novalidate" class="validate"><input type="email" value name="EMAIL" id="mce-EMAIL" placeholder="Email address" required="required" class="email">
        real people should not fill this in and expect good things - do not remove this or risk form bot
        signups
        <div aria-hidden="true" style="position: absolute; left: -5000px;"><input type="text" name="b_8eca8dc5c91c2e30d69b1463e_1447662093" tabindex="-1" value></div> <button type="submit">Submit</button></form></div></div> <div class="links-container"><ul class="learn"><li>Learn</li> <li><a href="https://www.terra.money/Terra_White_paper.pdf" target="_blank">
          White
          Paper
        </a></li> <li><a href="https://certik.org/projects/terra" target="_blank">Security Audit</a></li> <li><a href="https://agora.terra.money/" target="_blank">Agora Discussions</a></li></ul> <ul class="developers"><li>Tools</li> <li><a href="https://station.terra.money/" target="_blank">Terra Station</a></li> <li><a href="https://finder.terra.money/" target="_blank">Terra Finder</a></li> <li><a href="https://status.terra.money/" target="_blank">Status</a></li></ul> <ul class="developers"><li>Luna</li> <li><a href="https://docs.terra.money/Concepts/Protocol.html#terra-and-luna" target="_blank">What is Luna?</a></li> <li><a href="https://docs.terra.money/Reference/integrations.html#exchanges" target="_blank">Exchanges</a></li> <li><a href="https://docs.terra.money/Reference/integrations.html#wallets" target="_blank">Wallets</a></li></ul> <ul class="developers"><li>Foundation</li> <li><a href="https://terra.breezy.hr/" target="_blank">Careers</a></li></ul> <ul class="developers"><li>Developers</li> <li><a href="https://github.com/terra-money" target="_blank">Github</a></li> <li><a href="https://docs.terra.money/" target="_blank">Documentation</a></li> <li><a href="https://docs.terra.money/#sdks-for-developers" target="_blank">SDKs</a></li> <li><a href="https://github.com/terra-money/TIPs" target="_blank">TIPs</a></li></ul> <ul class="developers"><li>Validators</li> <li><a href="https://docs.terra.money/How-to/Manage-a-Terra-validator/Overview.html" target="_blank">Validator Guide</a></li> <li><a href="https://github.com/terra-money/validator-profiles" target="_blank">Profiles</a></li> <li><a href="https://discord.gg/ZHBuKda" target="_blank">Discord Channel</a></li></ul></div> <div class="sns-container"><div class="logos"><a href="https://discord.gg/e29HWwC2Mz" rel="noopener" target="_blank"><img src="/img/discord.svg" alt="link to Terra discord room"></a> <a href="https://medium.com/terra-money" rel="noopener" target="_blank"><img src="/img/medium.svg" alt="link to Terra medium"></a> <a href="https://twitter.com/terra_money" rel="noopener" target="_blank"><img src="/img/twitter.svg" alt="link to Terra twitter"></a> <a href="https://www.youtube.com/channel/UCoV1RXZ9ZBGcuu_PMTTlM0g" rel="noopener" target="_blank"><img src="/img/icon_youtube.png" alt="link to Terra youtube"></a> <a href="https://t.me/terra_announcements" rel="noopener" target="_blank"><img src="/img/icon_telegram.png" alt="link to Terra telegram room"></a></div> <a href="https://www.terra.money" target="_blank" class="terramoney">terra.money</a></div></div></main></div><div class="global-ui"><div class="darkmode-switch"><div class="item day active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M512 256a42.666667 42.666667 0 0 0 42.666667-42.666667V128a42.666667 42.666667 0 0 0-85.333334 0v85.333333a42.666667 42.666667 0 0 0 42.666667 42.666667zM896 469.333333h-85.333333a42.666667 42.666667 0 0 0 0 85.333334h85.333333a42.666667 42.666667 0 0 0 0-85.333334zM256 512a42.666667 42.666667 0 0 0-42.666667-42.666667H128a42.666667 42.666667 0 0 0 0 85.333334h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666667zM265.386667 213.333333a42.666667 42.666667 0 0 0-59.306667 62.72l61.44 59.306667a42.666667 42.666667 0 0 0 31.146667 11.946667 42.666667 42.666667 0 0 0 30.72-13.226667 42.666667 42.666667 0 0 0 0-60.16zM725.333333 347.306667a42.666667 42.666667 0 0 0 29.44-11.946667l61.44-59.306667A42.666667 42.666667 0 0 0 758.613333 213.333333l-61.44 60.586667a42.666667 42.666667 0 0 0 0 60.16 42.666667 42.666667 0 0 0 28.16 13.226667zM512 768a42.666667 42.666667 0 0 0-42.666667 42.666667v85.333333a42.666667 42.666667 0 0 0 85.333334 0v-85.333333a42.666667 42.666667 0 0 0-42.666667-42.666667zM756.48 688.64a42.666667 42.666667 0 0 0-59.306667 61.44L758.613333 810.666667a42.666667 42.666667 0 0 0 29.44 11.946666 42.666667 42.666667 0 0 0 30.72-12.8 42.666667 42.666667 0 0 0 0-60.586666zM267.52 688.64l-61.44 59.306667a42.666667 42.666667 0 0 0 0 60.586666 42.666667 42.666667 0 0 0 30.72 12.8 42.666667 42.666667 0 0 0 28.586667-10.666666l61.44-59.306667a42.666667 42.666667 0 0 0-59.306667-61.44zM512 341.333333a170.666667 170.666667 0 1 0 170.666667 170.666667 170.666667 170.666667 0 0 0-170.666667-170.666667z"></path></svg></div> <div class="item auto"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M460.864 539.072h103.936l-54.208-163.072-49.728 163.072z m411.136-176.704V149.504h-212.352L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352v-212.928l149.12-149.504-149.184-149.504zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624H320.768l144.576-407.68h90.368l144.576 407.68H614.464z m0 0"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M935.538601 630.40178c-11.43005-11.432249-28.673759-14.738607-43.531086-8.353536-46.733115 20.10317-96.362866 30.296859-147.50719 30.296859-99.589478 0-193.221796-38.783705-263.640252-109.20316-108.636744-108.636744-139.609745-270.022125-78.9083-411.148441 6.388069-14.85233 3.078713-32.098837-8.353536-43.532285-11.432249-11.432249-28.675758-14.743604-43.532285-8.354536-52.637312 22.64025-100.017388 54.809439-140.82552 95.616372-85.346135 85.346135-132.346869 198.821199-132.346869 319.519766 0 120.699566 47.001733 234.172631 132.347868 319.518766s198.821199 132.349067 319.517567 132.349067c120.699566 0 234.172431-47.002932 319.520765-132.351066 40.808132-40.810131 72.977122-88.190207 95.615373-140.82552C950.282205 659.081735 946.971849 641.834029 935.538601 630.40178z" p-id="3638"></path></svg></div></div></div></div>
    <script src="/assets/js/app.bb579b87.js" defer></script><script src="/assets/js/3.bd3f871b.js" defer></script><script src="/assets/js/56.50135bed.js" defer></script>
  </body>
</html>
